{"version":3,"file":"index.js","sources":["../src/utils/shallowEqual.ts","../src/utils/propsValidation.ts","../src/utils/bindActions.ts","../src/react/components/connect.tsx","../src/react/components/Provider.tsx"],"sourcesContent":["export default function shallowEqual(a, b) {\n  for (const i in a) if (a[i] !== b[i]) return false\n  for (const i in b) if (!(i in a)) return false\n  return true\n}\n","export default function propsValidation(\n  props: object,\n  propName: string,\n  componentName: string\n) {\n  if (typeof props === \"object\") {\n    return null\n  }\n  return new Error(`Invalid prop ${propName} supplied to ${componentName}`)\n}\n","export default function bindActions(actions, store) {\n  let bound = {}\n  for (let name in actions) {\n    bound[name] = (...args) => {\n      let ret = actions[name](store.getState(), ...args)\n      if (ret != null) store.setState(ret)\n    }\n  }\n  return bound\n}\n","import * as React from \"react\"\n\nimport shallowEqual from \"../../utils/shallowEqual\"\nimport propValidation from \"../../utils/propsValidation\"\nimport bindActions from \"../../utils/bindActions\"\n\nexport class Connect extends React.Component<any> {\n  static contextTypes = {\n    store: propValidation\n  }\n  unsubscribe\n  state = this.getProps()\n  actions = this.getActions()\n  componentWillMount() {\n    this.unsubscribe = this.context.store.subscribe(this.update)\n  }\n  componentWillUnmount() {\n    this.unsubscribe(this.update)\n  }\n  getProps() {\n    const { mapToProps } = this.props\n    const state = (this.context.store && this.context.store.getState()) || {}\n    return mapToProps(state, this.props)\n  }\n  getActions() {\n    const { actions } = this.props\n    return bindActions(\n      typeof actions === \"function\" ? actions(this.context.store) : actions,\n      this.context.store\n    )\n  }\n  update = () => {\n    const mapped = this.getProps()\n    if (!shallowEqual(mapped, this.state)) {\n      this.setState(mapped)\n    }\n  }\n  render() {\n    return this.props.children({\n      store: this.context.store,\n      ...this.state,\n      ...this.actions\n    })\n  }\n}\n\nexport default function connect(mapToProps, actions = {}) {\n  return Child => props => (\n    <Connect mapToProps={mapToProps} actions={actions}>\n      {mappedProps => <Child {...mappedProps} {...props} />}\n    </Connect>\n  )\n}\n","import * as React from \"react\"\n\nimport Props from \"../../interfaces/Props\"\nimport Store from \"../../interfaces/Store\"\nimport propValidation from \"../../utils/propsValidation\"\n\nexport default class Provider extends React.Component<Props, {}> {\n  static childContextTypes = {\n    store: propValidation\n  }\n  getChildContext() {\n    const { store } = this.props\n    return { store }\n  }\n  render() {\n    const { children } = this.props\n    return React.Children.only(children)\n  }\n}\n"],"names":["tslib_1.__extends","propValidation","React.Component","React.createElement","React.Children"],"mappings":"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"}